<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EcoHero</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-router-dom@6.16.0/dist/umd/react-router-dom.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prop-types@15.8.1/prop-types.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#16a34a" />
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const { BrowserRouter, Routes, Route, Link, useNavigate } = ReactRouterDOM;

    // Media.jsx
    const Media = ({ src, alt, type = 'image', isLive = false, onApplyARFilter }) => {
      if (type === 'image') {
        return (
          <div className="relative">
            <img src={src} alt={alt} className="w-full h-48 object-cover rounded-lg" />
            <button
              onClick={() => onApplyARFilter('tree')}
              className="absolute top-2 right-2 bg-green-600 text-white p-1 rounded"
            >
              Apply AR Filter
            </button>
          </div>
        );
      } else if (type === 'video') {
        return (
          <video
            src={src}
            controls
            autoPlay={isLive}
            className="w-full h-48 rounded-lg"
          >
            Your browser does not support the video tag.
          </video>
        );
      } else if (type === 'live') {
        return (
          <div className="relative">
            <video src={src} autoPlay muted className="w-full h-48 rounded-lg" />
            <span className="absolute top-2 left-2 bg-red-600 text-white px-2 rounded">LIVE</span>
          </div>
        );
      }
      return null;
    };
    Media.propTypes = {
      src: PropTypes.string.isRequired,
      alt: PropTypes.string,
      type: PropTypes.oneOf(['image', 'video', 'live']),
      isLive: PropTypes.bool,
      onApplyARFilter: PropTypes.func,
    };

    // PostCard.jsx
    const PostCard = ({ post, isSponsored = false }) => {
      const [likes, setLikes] = useState(post.likes || 0);
      const [ecoEmoji, setEcoEmoji] = useState(null);
      const handleLike = () => setLikes(likes + 1);
      const handleEcoEmoji = (emoji) => setEcoEmoji(emoji);
      const applyARFilter = (filter) => alert(`Applying ${filter} AR filter`);
      return (
        <div className={`bg-white p-4 mb-4 rounded-lg shadow-md ${isSponsored ? 'border-2 border-green-400' : ''}`}>
          {isSponsored && <span className="text-xs text-green-600 font-bold mb-2 block">Sponsored</span>}
          <div className="flex items-center mb-2">
            <img
              src={post.userAvatar || 'https://via.placeholder.com/40'}
              alt="User avatar"
              className="w-10 h-10 rounded-full mr-2"
            />
            <div>
              <h3 className="text-green-700 font-semibold">
                {post.username}
                {post.isPro && <span className="ml-2 text-yellow-500">â˜… Pro</span>}
              </h3>
              <p className="text-gray-500 text-sm">{new Date(post.timestamp).toLocaleString()}</p>
            </div>
          </div>
          <p className="text-gray-800 mb-2">{post.text}</p>
          {post.media && (
            <Media
              src={post.media.url}
              alt={post.text}
              type={post.media.type || 'image'}
              isLive={post.isLive}
              onApplyARFilter={applyARFilter}
            />
          )}
          <div className="flex justify-between mt-2">
            <div className="flex space-x-2">
              <button onClick={handleLike} className="text-green-600">{likes} ðŸŒ¿</button>
              <button onClick={() => handleEcoEmoji('ðŸŒ³')} className="text-green-600">{ecoEmoji || 'ðŸŒ³'}</button>
            </div>
            {post.isLive && (
              <button className="bg-blue-600 text-white p-1 rounded">Tip $5</button>
            )}
          </div>
          {isSponsored && (
            <a href={post.sponsorLink} className="text-green-600 underline text-sm">
              Learn More
            </a>
          )}
        </div>
      );
    };
    PostCard.propTypes = {
      post: PropTypes.shape({
        username: PropTypes.string.isRequired,
        userAvatar: PropTypes.string,
        text: PropTypes.string.isRequired,
        timestamp: PropTypes.string.isRequired,
        isPro: PropTypes.bool,
        likes: PropTypes.number,
        isLive: PropTypes.bool,
        media: PropTypes.shape({
          url: PropTypes.string,
          type: PropTypes.string,
        }),
      }).isRequired,
      isSponsored: PropTypes.bool,
    };

    // FeedScreen.jsx
    const dummyPosts = [
      {
        username: 'EcoWarrior',
        userAvatar: 'https://via.placeholder.com/40',
        text: 'Planted 10 trees today! ðŸŒ³',
        timestamp: '2025-04-22T10:00:00Z',
        isPro: true,
        media: { url: 'https://via.placeholder.com/300', type: 'video' },
        likes: 100,
      },
      {
        username: 'GreenBrand',
        text: 'Discover our eco-friendly water bottles! #SustainableLiving',
        timestamp: '2025-04-22T09:30:00Z',
        isSponsored: true,
        sponsorLink: 'https://example.com/eco-bottles',
        likes: 50,
      },
      {
        username: 'GreenLiving',
        text: 'Live eco-event starting now! Join us!',
        timestamp: '2025-04-22T09:00:00Z',
        isLive: true,
        media: { url: 'https://via.placeholder.com/300', type: 'live' },
        likes: 200,
      },
    ];
    const FeedScreen = () => {
      return (
        <div className="p-4 bg-gray-100 min-h-screen">
          <h2 className="text-2xl font-bold text-green-700 mb-4">Community Feed</h2>
          <p className="text-gray-600 mb-4">Earn points by liking or sharing posts!</p>
          {dummyPosts.map((post, index) => (
            <PostCard
              key={index}
              post={post}
              isSponsored={post.isSponsored || false}
              sponsorLink={post.sponsorLink}
            />
          ))}
        </div>
      );
    };

    // Render
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<FeedScreen />);
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js');
    }
  </script>
</body>
</html>